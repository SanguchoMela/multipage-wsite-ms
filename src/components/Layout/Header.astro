---
import { Icon } from "astro-icon/components";
import { navbarItems } from "../../data/navbarItems";
import { socials } from "../../data/socials";
---

<header class="fixed top-0 left-0 w-full z-50 bg-amber-50">
  <nav
    class="py-4 flex justify-evenly items-center relative h-10 lg:h-14 bg-amber-50"
  >
    <div class="flex space-x-3 items-center text-amber-900">
      <Icon name="logo/coffe" class="lg:text-3xl text-2xl" />
      <Icon name="logo/abc" class="lg:text-6xl text-4xl" />
    </div>
    <input id="menu-toggle" type="checkbox" class="hidden" />

    <ul class="hidden lg:flex space-x-6">
      {
        navbarItems.map((item) => (
          <li>
            <a
              href={item.ref}
              class="nav-item px-4 py-2 font-semibold text-slate-500 hover:text-slate-700 transition-colors"
            >
              {item.name}
            </a>
          </li>
        ))
      }
    </ul>
    <ul class="hidden md:flex space-x-8">
      {
        socials.map((item) => (
          <li>
            <a
              href={item.ref}
              aria-label={item.name}
              target="_blank"
              rel="noopener noreferrer"
            >
              <Icon
                name={item.icon}
                class="text-xl text-slate-500 hover:text-slate-700"
              />
            </a>
          </li>
        ))
      }
    </ul>
    <label for="menu-toggle" class="lg:hidden cursor-pointer z-50"
      ><Icon
        name="ui/menu"
        class="text-xl text-slate-500 hover:text-slate-700"
      /></label
    >
  </nav>
</header>

<div id="overlay" class="hidden fixed inset-0 bg-black/30 z-40"></div>

<ul
  id="mobile-menu"
  class="hidden flex-col text-center fixed top-[42px] right-6 rounded-md bg-white w-48 z-50"
>
  {
    navbarItems.map((item) => (
      <li>
        <a
          href={item.ref}
          class="nav-item block px-4 py-2 rounded-lg hover:bg-slate-200 hover:text-amber-700 duration-300"
        >
          {item.name}
        </a>
      </li>
    ))
  }
  <hr class="text-gray-300 md:hidden" />
  <ul class="flex md:hidden justify-evenly">
    {
      socials.map((item) => (
        <li>
          <a
            href={item.ref}
            aria-label={item.name}
            target="_blank"
            rel="noopener noreferrer"
            class="block p-3 hover:bg-gray-100 hover:text-amber-700 duration-300"
          >
            <Icon name={item.icon} class="text-xl" />
          </a>
        </li>
      ))
    }
  </ul>
</ul>

<script>
  const toggle = document.getElementById("menu-toggle") as HTMLInputElement;
  const menu = document.getElementById("mobile-menu") as HTMLElement;
  const overlay = document.getElementById("overlay") as HTMLElement;
  const navItems = document.querySelectorAll(".nav-item");

  function closeMenu() {
    toggle.checked = false;
    menu.classList.add("hidden");
    overlay.classList.add("hidden");
  }

  toggle.addEventListener("change", () => {
    if (toggle.checked) {
      menu.classList.remove("hidden");
      overlay.classList.remove("hidden");
    } else {
      closeMenu();
    }
  });

  overlay.addEventListener("click", closeMenu);

  navItems.forEach((item) => item.addEventListener("click", closeMenu));

  document.addEventListener("DOMContentLoaded", () => {
    // const navItems = document.querySelectorAll(".nav-item");
    const currentUrl = window.location.pathname;
    navItems.forEach((item) => {
      const itemUrl = item.getAttribute("href");
      if (itemUrl === currentUrl) {
        item.classList.add("text-slate-700");
      } else {
        item.classList.remove("text-slate-700");
      }
    });
  });

  document.addEventListener("scroll", () => {
    const header = document.querySelector("header");
    if (window.scrollY > 50) {
      header?.classList.add("shadow-md");
    } else {
      header?.classList.remove("shadow-md");
    }
  });
</script>
